Testing procedure before release
''''''''''''''''''''''''''''''''

First of all, build the packages, compute SHA256 sums and upload
packages to the remote server using the following command::

	sudo make release &&
	ssh releases.neubot.org rm -rf rc/* &&
	scp dist/* releases.neubot.org:rc/

Testing under debian.  We assume that the debian machine has already
installed a previous version of Neubot, so we can test whether the update
will work.  To be sure::

	neubot -V

Download and update to the latest package, make sure it is running
and then open the web user interface::

	wget http://releases.neubot.org/rc/neubot-0.4-rc5-1_all.deb &&
	sudo dpkg -i neubot-0.4-rc5-1_all.deb &&
	wget -O- 'http://127.0.0.1:9774/api/state?debug=1' &&
	wget -O- http://127.0.0.1:9774/api/debug &&
	neubot -V && neubot

Make sure that the user interface i18n works by switching your browser
to a different language and making sure than all pages are correctly
translated (expecially log, speedtest and bittorrent that have had some
glitches in the past).  Please note that this might not work with FF
less than 5.0 because of a known bug.

Reboot the debian machine than make sure that Neubot is still working
using the command line::

	neubot -V &&
	wget -O- 'http://127.0.0.1:9774/api/state?debug=1' &&
	wget -O- http://127.0.0.1:9774/api/debug

Stop neubot, run a private copy of Neubot without privacy permissions
and claiming to be an old version and make sure that after some seconds
a popup will inform you of that::

	neubot stop &&
	neubot agent -D agent.master=neubot.unipv.it \
	             -D rendezvous.client=0.1 \
	             -D privacy.informed=NO -D privacy.can_collect=NO \
	             -D privacy.can_share=NO &&
	neubot on_gui_login

The popup should appear in less then one minute.  Click on the links to
make sure they work and then close your private neubot instance::

	neubot stop

Reinstall the package over itself to make sure that future updates are
going to work (we must test the uninstall script of the new package)::

	sudo dpkg -i neubot-0.4-rc5-1_all.deb &&
	wget -O- 'http://127.0.0.1:9774/api/state?debug=1' &&
	wget -O- http://127.0.0.1:9774/api/debug &&
	neubot -V && neubot

.. TODO Update check for on_gui_login when it will run forever
Open the status icon and then reinstall the package to make sure that
the uninstall script correctly tears down the icon before uninstalling
Neubot.

	neubot statusicon &&
	sudo dpkg -i neubot-0.4-rc5-1_all.deb &&
	wget -O- 'http://127.0.0.1:9774/api/state?debug=1' &&
	wget -O- http://127.0.0.1:9774/api/debug &&
	neubot -V && neubot

Make sure that bittorrent and speedtest tests work from command
line using the following command::

	neubot bittorrent && neubot speedtest

